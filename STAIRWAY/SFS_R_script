Terminal 
# Allele count
# Sara github "# filter VCF for allele counts
cd stairway
cp ../hetAtr_stiNae_qc/hetAtr.filtered.vcf .
vcftools --vcf hetAtr.filtered.vcf --max-missing 1 --min-alleles 2 --max-alleles 2 --remove-filtered-all --remove-indels --out hetAtr --counts2"

#Mine
vcftools --vcf oncNer.vcf --counts2 --out oncNer_counts2


#New Window
sftp francine@fir.computecanada.ca
sftp> cd scratch/W25/data
sftp> lcd Desktop
sftp> get oncNer_counts2.frq.count

RSTUDIO

```{r}
library(tidyverse)
```

## Calculate SFS

```{r}
# following Sara script 
allele_count <- read_delim("oncNer_counts2.frq.count",delim = "\t",col_names = TRUE)
#warning message:
#One or more parsing issues, call `problems()` on your data frame for details, e.g.:
 # dat <- vroom(...)
  #problems(dat) 
#
#> View(allele_count)
#> 
#> # A tibble: 6,998,391 × 5
#     row   col expected  actual    file                                                                       
 #  <int> <int> <chr>     <chr>     <chr>                                                                      
 #1     2     6 5 columns 6 columns /Users/francinecerbino/Desktop/HONOURS/Honours W26/oncNer_counts2.frq.count
 #2     3     6 5 columns 6 columns /Users/francinecerbino/Desktop/HONOURS/Honours W26/oncNer_counts2.frq.count
 #3     4     6 5 columns 6 columns /Users/francinecerbino/Desktop/HONOURS/Honours W26/oncNer_counts2.frq.count
 #4     5     6 5 columns 6 columns /Users/francinecerbino/Desktop/HONOURS/Honours W26/oncNer_counts2.frq.count
 #5     6     6 5 columns 6 columns /Users/francinecerbino/Desktop/HONOURS/Honours W26/oncNer_counts2.frq.count
# ℹ 6,998,381 more rows
# ℹ Use `print(n = ...)` to see more rows

# Will ignore this for now
# but I cannot follow the script because I don't have major and minor, so fix that

```

```{r}
# separate the count column

allele_sep <- allele_count %>%
  separate( `{COUNT}`, into = c("MAJOR", "MINOR"), sep = " ")

# error for every line, use tab

allele_sep <- allele_count %>%
  separate( `{COUNT}`, into = c("MAJOR", "MINOR"), sep = "\t")
 #worked, but I just noticed line 25, the smaller number is first, so this is wrong I think 

```
